config_version: 1

engine:
  allow_overlapping_events: false
  freeze_mean_on_event: false
  freeze_volatility_on_event: false
  max_active_events: 1

ratio_universe:
  k_num: 4
  k_den: 4
  disallow_overlap: true
  unordered_if_equal_k: true
  max_jobs: 50000

data:
  price_field: close
  returns_mode: log
  min_bars_required: 100
  tickers:
    - BTC-USD
    - GC=F
    - SI=F
    - XRP-USD
    - SOL-USD
    - ADA-USD
    - XOM
    - CVX
    - COP
    - EOG
    - OXY
    - DVN
    - APA
    - FANG
    - PR
  period: 5y
  interval: 1d
  ending_date: "2025-05-05"  # optional YYYY-MM-DD
  cache:
    enabled: false
    path: .cache/yfinance

# Basic Mean Estimator
mean_estimator:
  type: rolling_sma
  params:
    window: 50

# Production
# mean_estimator:
#   type: ema
#   params:
#     span: 50
#     min_periods: 10

# Advanced Mean Estimator
# mean_estimator:
#   type: kalman_mean
#   params:
      # process_var: 0.01
      #     obs_var: 1.0
      #     init_mean: 0.0
      #     init_var: 10.0
      #     min_periods: 5

volatility_estimator:
  type: ewma
  params:
    span: 30
    min_volatility: 0.0005
    volatility_unit: returns
# Production
# volatility_estimator:
#   type: ewma
#   params:
#     span: 30
#     min_periods: 10
#     min_volatility: 0.0005
#     volatility_unit: returns

# Advanced Volatility Estimator
# volatility_estimator:
#   type: garch11
#   params:
#     omega: 1.0e-6
#     alpha: 0.08
#     beta: 0.90
#     min_volatility: 0.0005
#     min_periods: 10
#     enforce_stationarity: true
#     volatility_unit: returns


deviation_detector:
  type: zscore
  params:
    threshold: 1.75
    min_absolute_move: 0.002

reversion_criteria:
  type: soft_band
  params:
    z_tolerance: 0.4

failure_criteria:
  type: composite
  params:
    max_duration: 40
    max_zscore: 3.5

scoring:
  by_direction: true
  by_volatility_bucket: true
  volatility_buckets: 5
  record_empty_scores: false

diagnostics:
  enabled: true
  record_event_paths: true
  record_max_excursion: true
  record_time_to_resolution: true

visualization:
  show_ratio: true
  show_log_ratio: false
  show_zscore: false
  show_returns: false
  top_k: 5

backtest:
  enabled: true
  initial_cash: 100000

  sizing:
    notional_per_trade: 10000
    max_gross_leverage: 2.0

  costs:
    commission_bps: 0.5
    slippage_bps: 1.0
    borrow_bps: 0.0

  hedge:
    mode: dollar_neutral
    leg_split: [0.5, 0.5]

  strategy:
    type: ratio_mean_reversion
    params:
      signal_series: log_ratio
      use_global_deviation_detector: true
      use_global_reversion_criteria: true
      use_global_failure_criteria: true

  output:
    store_equity_curve: true
    store_trades: true
